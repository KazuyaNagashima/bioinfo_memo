### 5-NGSデータ概論  

#### NGSとは  
2007年に誕生し、急速に普及したNGSは、従来のサンガー法を用いた旧世代のシーケンサーよりも同時処理が可能(超並列)であるため、より高速である。  

インサートサイズ(またはフラグメントサイズ)：解析に使用する断片配列の長さ。おおむね数百塩基であるが、指定した配列長と全く同じ長さの断片のみを回収できているわけではない。基本的にはこの末端のみが読まれる。  
シングルエンドとペアエンド：末端配列の読み方。片側だけ読むのをシングルエンド、両側を読むのがペアエンドである。  
リード：読み取られた配列。配列の長さはリード長といい、矢印の長さに相当する。ex)NovaSeq(illumina)は３種類のリード長(50bp,100bp,150bp)のいずれかを指定可能。  

#### さまざまなNGS機器  
* イルミナ社:算出するデータ量やコストなど、リード長以外では他社を圧倒している。
* Pacific Biosciences社(PacBio Sequelシステムなど):リード長が平均10,000bpに達するほどのロングリードデータを出力するため、反復配列を多く含む生物種の配列決定の際は有利。  
* オックスフォード・ナノポア社(MinIONシステムなど):USB程度の大きさのポータブル型NGS機器であるため、利便性やコンプライアンスの面で優れている。  

#### NGSの利用例１(de novo アセンブリ)  
de novo:リードデータのみを用いての意味。  
→得られた配列情報のみで、新たな配列を決定すること。  
コンティグ(contig):デノボアセンブリの結果、得られた塩基配列のこと。  

反復配列の長さよりもリード長が短い場合  
 →アセンブラは曖昧さを回避するため、反復配列領域で分断する。その結果コンティグ数が増加するが、欲しいのはコンティグ数が少なく、コンティグあたりの配列長が長い結果である。したがって、ペアエンドシーケンスデータを用いるのが一般的である(ロングリードだと反復配列を乗り超えられるため、さらに有効)。  

#### NGSの利用例２(リシークエンス/変異解析)  
配列解読後の配列を再びシークエンスするという意味でリシークエンスと呼ばれ、主にヒトが対象である。リファレンス配列と異なる箇所を変異と同定する。この種の変異解析は豊富なリード数を出力可能なショートリードデータが利用される。  

#### 解析に必要なデータ量(カバレッジ)  
de novoアセンブリや変異解析ではゲノムサイズの数十倍程度のデータ量が必要である。表現の仕方としてはゲノムサイズの1.5倍程度であれば、「カバレッジ(coverage)1.5×」とする。~2×程度では、de novoではコンティグが得られず、変異解析では信頼性を担保できない。  

#### 塩基配列決定精度とクオリティコントロール  
ベースコール:塩基配列を決定する作業のこと。エラー率 _p_ は、NGS機器によっても異なるが。0.1~15%程度である。  
※歴史的経緯により、NGS分野ではエラー率 _p_ そのものではなく、クオリティスコア(Q)の値に基づいてベースコール精度が議論される。一般的に、NGS機器は読み進めていくにつれ配列決定精度が落ちる。(Q = -10 × log10(_p_))  
ex) p=0.001の場合は Q = -10 × log10(0.001) = 30 となる。  
illumina社のNovaSeqシステムを用いて150bpのペアエンドシーケンスを行った時のカタログ値は、出力される全リードの75%以上がクオリティスコア30(Q30)以上である。  
　→ 実際の解析現場では・・・  
* クオリティチェック(クオリティスコアの分布を見る)  
* クオリティフィルタリング(Q値の低いリードを除く)  
* トリミング(リード中のQ値が低い塩基を除く)  
といった前処理(クオリティコントロール:QC)が行われる。  

#### 実データ概観(DDBJ SRA)  
NGSから出力された生データの多くは公共データベースに送付される。日本ではDDBJがDDBJ Sequence Read Archive (通称DRA)という名前で運用している。  

#### NGSデータのファイル形式  
配列情報とクオリティスコア情報が記されたファイルには、FASTQ形式(情報:テキスト形式)とSRA形式(情報:バイナリ形式)がある。  
<FASTQ形式の読み方>  
FASTQファイルは4行で1つのReadを示す。  
1行目:リードのIDなどの任意の情報を書く。(@で始まる)  
2行目:塩基配列の情報を書く。  
3行目:リードのIDなどの任意の情報を書く。(+で始まる)  
4行目:クオリティ情報を書く。ex) Q40=I, Q39=H, Q37=F, Q38=G, Q11=,(カンマ), Q1=16 で示す。  

#### 他のファイル形式  
FASTA形式:塩基配列のみでクオリティスコアを含まないファイル。de novoアセンブリの出力結果ファイル。contigごとの配列が分かる。  
SAM形式:得られリードのリファレンス配列との比較結果を格納したファイル。テキスト形式。  
BAM形式:SAMのバイナリ形式。  
VCF形式:バリアントの情報のみを格納したファイル。ex)17番目のAがCに変異  
GFF形式(GTF形式):リファレンスゲノム配列のアノテーション情報が含まれているファイル。  
